@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

@model CI_PlatForm.Entities.ViewModel.StoryViewModel

@{
    @Html.Partial("_TopNav")
    <div class = "container">
    <div class = "row">
    <div class = "col-lg-6 col-md-6 col-12">
    <div class="w3-content" style="max-width:1200px">
                                      <img class="mySlides" src="/Images/CI Platform Assets/Grow-Trees-On-the-path-to-environment-sustainability-1.png" style="width:100%;display:none">
                                      <img class="mySlides" src="/Images/CI Platform Assets/Animal-welfare-&-save-birds-campaign-1.png" style="width:100%">
                                      <img class="mySlides" src="/Images/CI Platform Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-1.png" style="width:100%;display:none">

                                      <div class="w3-row-padding w3-section">
                                        <div class="w3-col s4">
                                          <img class="demo w3-opacity w3-hover-opacity-off" src="/Images/CI Platform Assets/Grow-Trees-On-the-path-to-environment-sustainability-1.png" style="width:100%;cursor:pointer" onclick="currentDiv(1)">
                                        </div>
                                        <div class="w3-col s4">
                                          <img class="demo w3-opacity w3-hover-opacity-off" src="/Images/CI Platform Assets/Animal-welfare-&-save-birds-campaign-1.png" style="width:100%;cursor:pointer" onclick="currentDiv(2)">
                                        </div>
                                        <div class="w3-col s4">
                                          <img class="demo w3-opacity w3-hover-opacity-off" src="/Images/CI Platform Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-1.png" style="width:100%;cursor:pointer" onclick="currentDiv(3)">
                                        </div>
                                      </div>
                                    </div>
                                  @*<div class="carousel slide" data-bs-interval="false" id="sub-images">
                                  <div class="carousel-inner">
                        @{
                            int count = 0;
                            foreach(var item in Model.storymedia)
                            {
                                if(count == 0)
                                {
                                    <img class="w-100 carousel-item active main-image" src="~/Images/CI Platform Assets/@item.Path" alt="Story images">
                                    count = count + 1;
                                }
                                else
                                {
                                    <img class="w-100 carousel-item main-image" src="~/Images/CI Platform Assets/@item.Path" alt="Story images">


                                }

                            }
                        }</div>
                    <div class="mt-1 w-100 position-relative">
                        <div class="carousel slide" data-bs-interval="false" id="other-images">
                            <div class="carousel-inner">
                                @{
                                    int sub_count = 4;
                                    int check = 0;
                                    int carousel_count = (int)Math.Ceiling((double)@Model.storymedia.Count / 4);
                                    for(var i = 0; i < carousel_count; i ++){
                                        if(check == 0)
                                        {
                                            <div class = "carousel-item active">
                                                <div class="d-flex">
                                                    @if (@Model.storymedia.Count >= sub_count)
                                                    {
                                                        @for(int j = 0; j < sub_count; j++)
                                                        {
                                                            <img src="/Images/CI Platform Assets/@Model?.storymedia.ElementAt(j).Path" data-bs-target="#sub-images" data-bs-slide-to=@j class="other-image" alt="">
                                                        }
                                                    }
                                                    else
                                                    {
                                                        @for(int j = 0; j < @Model?.storymedia.Count; j++)
                                                        {
                                                           <img src="~/Images/CI Platform Assets/@Model?.storymedia.ElementAt(j).Path" data-bs-target="#sub-images" data-bs-slide-to=@j class="other-image" alt="">
                                                        }
                                                    }
                                                </div>
                                            </div>
                                            check = check + 4;
                                        }
                                        else
                                        {
                                            <div class="carousel-item">
                                                <div class="d-flex">
                                                    @if (@Model?.storymedia.Count - (4 * i) >= sub_count)
                                                    {
                                                        @for(int j = 0; j < sub_count + check; j++)
                                                        {
                                                            <img src="/@Model?.storymedia.ElementAt(j).Path" data-bs-target="#sub-images" data-bs-slide-to=@j class="other-image" alt="">
                                                        }
                                                    }
                                                    else
                                                    {
                                                        @for(int j = check; j < @Model?.storymedia.Count; j++)
                                                        {
                                                            <img src="/@Model?.storymedia.ElementAt(j).Path" data-bs-target="#sub-images" data-bs-slide-to="other-image" alt="">
                                                        }
                                                    }
                                                </div>
                                            </div>
                                            check = check + 4;
                                        }
                                    }
                                }</div></div></div></div>*@
            </div>
                            <div class = "col-lg-6 col-md-6 col-12">
                            <div class = "row">
                            
                            <div class="col-3">
                            <img src="/Images/CI Platform Assets/@Model.Avatar" class="rounded-circle text-center">
                         

                        </div>
                         </div>
                         <div class = "row">
                         <div class = "col-3">
                            <div class="text-center">@Model.UserName
                            </div>
                            </div>
                            <div class="col-9 text-end">
                            <button type="button" class="btn btn-outline-secondary border rounded-pill">
                            <i class="bi bi-eye"></i>&nbsp;@Model.Views views</button>
                            </div>
                            
                            </div>
                            <div class = "row">
                            
                                 <p> @Model.Description</p>
                             
                          </div>
                          <div class="row">
                          <div class="col-lg-8 col-md-8 col-12">
                          <button type="button" class="btn btn-outline-secondary border rounded-pill w-100" data-bs-toggle="modal" data-bs-target="#exampleModal"><img src="/Images/CI Platform Assets/add1.png"> &nbsp; Recommanded to Co-Worker</button>
                             <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Co-Worker List</h5>

                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                                            </div>
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Select</th>
                                                        <th>Name</th>
                                                        <th>Email</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var worker in @ViewBag.userDetails)
                                                    {
                                                        <tr>
                                                            <td>
                                                                <div class="form-check">
                                                                    <input class="form-check-input"  name="volunteers" type="checkbox" value="@worker.FirstName" id="@worker.UserId" />
                                                                    <input type="hidden" id="uid" value="@worker.UserId" />
                                                                </div>
                                                            </td>
                                                            <td>@worker.FirstName @worker.LastName</td>
                                                            <td>@worker.Email</td>
                                                        </tr>
                                                    }
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="3">
                                                            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                                            <button type="submit" onclick="sendInvitation(@ViewBag.cardData.MissionId)" class="btn btn-success">Send Invitation</button>
                                                        </td>
                                                    </tr>
                                                </tfoot>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                          </div>
                          <div class = "col-lg-4 col-md-4 clo-12">
                          <button type="button" class="btn btn-outline-warning border rounded-pill w-100">Open Mission &nbsp; <img src="/Images/CI Platform Assets/right-arrow.png" /></button>
                          </div>
                          </div>
                          </div>
                            
                       </div>
                       </div>
                       <div class="container">
                       <div class= "row">
                       <p>Lorem ipsum dolor sit amet. Aut internos accusamus qui praesentium quod et autem fugit in error galisum sed obcaecati quia ad repellat molestias! Eum velit officia cum eveniet voluptatem sit natus repudiandae vel similique maiores. Et omnis placeat aut Quis dicta aut praesentium Quis. 33 dolorem voluptatem ex quia nesciunt ea nemo voluptate eum voluptas amet id deleniti nihil. </p><p>Qui quia earum cum voluptatem animi in earum dolores ut quos accusantium? Sed rerum veniam in facilis harum aut velit totam est beatae voluptates sit magni eius? </p>
                       <ul><li>Qui quia earum cum voluptatem animi in earum dolores ut quos accusantium? Sed rerum veniam in facilis harum aut velit totam est beatae voluptates sit magni eius?</li>
                       <li>Qui quia earum cum voluptatem animi in earum dolores ut quos accusantium? Sed rerum veniam in facilis harum aut velit totam est beatae voluptates sit magni eius? 
                       </li>
                       <li>Qui quia earum cum voluptatem animi in earum dolores ut quos accusantium? Sed rerum veniam in facilis harum aut velit totam est beatae voluptates sit magni eius?</li></ul></div>
                       </div>

                       <script>

                        function currentDiv(n) {
                      showDivs(slideIndex = n);
                    }

                    function showDivs(n) {
                      var i;
                      var x = document.getElementsByClassName("mySlides");
                      var dots = document.getElementsByClassName("demo");
                      if (n > x.length) {slideIndex = 1}
                      if (n < 1) {slideIndex = x.length}
                      for (i = 0; i < x.length; i++) {
                        x[i].style.display = "none";
                      }
                      for (i = 0; i < dots.length; i++) {
                        dots[i].className = dots[i].className.replace(" w3-opacity-off", "");
                      }
                      x[slideIndex-1].style.display = "block";
                      dots[slideIndex-1].className += " w3-opacity-off";
                    }
                    function sendInvitation(MissionId)
                        {
                            var VolunteerList = [];

                             $('input[name="volunteers"]:checked').each(function(){
                                 VolunteerList.push(this.id);
                             });
                            debugger
                             $.ajax({
                                 url:"/Mission/VolunteerList",
                                 method: "POST",
                                 data:{
                                     "MissionId" : MissionId,
                                     "Volunteers" : VolunteerList
                                 },
                                 success:function(data){
                                    if(data == true){
                                        toastr.success('Mail sent successfully');
                                    }
                                    else{
                                        toastr.error('Mail did not send successfully');
                                    }
                                 },
                                 error: function(request,error){
                 
                                     console.log(error);
                                 }
                             })

                        }
                    </script>
                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
                                    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
                                    crossorigin="anonymous"></script>
}

