@model CI_Platform.Entities.Models.Country


@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
   
                      @Html.Partial("_TopNav")
                     
                        <hr />
                       @* <div class="container">
                        <div class="row py-0">
                            <div class="col-lg-6 col-12">
                    
                                <div class="input-group mb-3">
                                    <span class="input-group-text" id="inputGroup-sizing-default"><i class="bi bi-search"></i></span>
                                    <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" placeholder="Search Mission..." oninput="searchMission()" name="search">
                                </div>
                    
                            </div>
                            <div class="col-lg-6 col-12 ">
                                    <div class="row ">
                    <div class="col-lg-3 col-3">



                        <div class="form-select d-flex align-items-center   hide_border_select border-0"
                             type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                            Country
                        </div>

                        <ul class="dropdown-menu scroll_dropdown " onchange="GetCity();searchMission();">

                            @foreach (var obj in @ViewBag.CountryList)
                            {
                                <li>
                                    <div class="form-check dropdown-item px-2">
                                        <input class="form-check-input mx-auto" type="checkbox" name="country"
                                           id="@obj.CountryId" />
                                        <label class="form-check-label ps-2" for="@obj.CountryId">
                                            @obj.CountryName
                                        </label>
                                    </div>
                                </li>
                            }
                        </ul>
                     </div>
                   <div class="col-lg-3 col-3">
                                    <div class="form-select select-menu border-lg-left border-0" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                        City
                                    </div>
                                     <ul class="dropdown-menu scroll_dropdown" id="selectCityList" onchange="searchMission()"  name="city">
                                     </ul>
                                    </div>
                                    
                                    <div class="col-lg-3 col-3">
                                      
                        <div class="form-select d-flex align-items-center   hide_border_select border-0"
                             type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                            Theme
                        </div>

                        <ul class="dropdown-menu scroll_dropdown " onchange="searchMission();">

                            @foreach (var obj in @ViewBag.missionTheme)
                            {
                                <li>
                                    <div class="form-check dropdown-item px-2">
                                        <input class="form-check-input mx-auto" type="checkbox" name="theme"
                                           id="@obj.MissionThemeId" />
                                        <label class="form-check-label ps-2" for="@obj.MissionThemeId">
                                            @obj.Title
                                        </label>
                                    </div>
                                </li>
                            }
                        </ul>
                     </div>
                   <div class="col-lg-3 col-3">
                                      
                          <div class="form-select d-flex align-items-center   hide_border_select border-0" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                            Skill
                           </div>

                           <ul class="dropdown-menu scroll_dropdown " onchange="searchMission();">

                            @foreach (var obj in @ViewBag.skillList)
                            {
                                <li>
                                    <div class="form-check dropdown-item px-2">
                                        <input class="form-check-input mx-auto" type="checkbox" name="skill"
                                           id="@obj.SkillId" />
                                        <label class="form-check-label ps-2" for="@obj.SkillId">
                                            @obj.SkillName
                                        </label>
                                    </div>
                                </li>
                            }
                              </ul>
                               

                                    </div>
                    
                                </div>
                            </div>
                        </div>
                    </div>*@

                    @Html.Partial("_SecondNav")
                
                    <hr />
                     @*<div class="container">
                     <div class="d-flex">
                     <button type="button" class="border rounded-pill btn-outline-secondary" id="countryName"></button>
                     <button type="button" class="border rounded-pill btn-outline-secondary" id="cityName"></button>
                     <button type="button" class="border rounded-pill btn-outline-secondary" id="themeName"></button>
                     <button type="button" class="border rounded-pill btn-outline-secondary" id="skillName"></button>
                     </div>
                                   <script>
                                    function GetCountry(){
                                    var $copyCountry = $("#countrySelector").clone();
                                    $("#countryName").append($copyCountry);
                                    }
                                    function GetCity(){
                                    var $copyCity = $("#citySelector").clone();
                                    $("#cityName").append($copyCity);
                                    }
                                    function GetTheme(){
                                    var $copyTheme = $("#themeSelector").clone();
                                    $("#themeName").append($copyTheme);
                                    }
                                    function GetSkill(){
                                    var $copySkill = $("#skillSelector").clone();
                                    $("#skillName").append($copySkill);
                                    }


                                    /*
                                    $("#batchSelector").hide();
                                    $(document).ready(){
                                        $("#batchSelector").click(function(){
                                            $("#batchSelector".show();
                                        
                                        })
                                    }                                
                                    */
                                    </script>
                                   </div>*@
                                  <div class="container">
                                    
                                        <div class="row">
                                            <div class="col-lg-9 col-md-9 col-6">Explore @ViewBag.totalMission Missions</div>
                                            <div class="col-lg-3 col-md-3 col-6">

                                                <div class="d-flex justify-content-end">
                                                   @* <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                        Sort by
                                                        <img src="/Images/CI Platform Assets/drop-down.png"
                                                            alt="Profile-dropdown" />&nbsp;&nbsp;&nbsp;
                                                    </a>
                                                    @*<ul class="dropdown-menu" name="sortBy">
                                                       <li><a class="dropdown-item" value="1">Latest First</a></li>
                                                        <li><a class="dropdown-item" value="2">Oldest First</a></li>
                                                        <li><a class="dropdown-item" value="3">Sort by Deadline</a></li>
                                                         <li><a class="dropdown-item" value="4">Sort by available seats</a></li>*@
                                                           <select aria-label="Default select example" id="sortBy" onchange="searchMission()" class="form-select border-0" style="box-shadow: none;">
                                                            <option selected>Sort By</option>
                                                            <option value="1">Latest First</option>
                                                            <option value="2">Oldest First</option>
                                                            <option value="3">Sort by Deadline</option>
                                                            <option value="4">Sort by available Seats</option>
                                                           @* <option value="5">Highest Available Seats</option>
                                                            <option value="6">Sort by my Favourite</option>*@
                                                        </select>

                                                   @* </ul>*@

                                                    <i class="d-sm-none d-md-block bi bi-list" id="list"></i>&nbsp;&nbsp;
                                                    <i class="d-sm-none d-md-block bi bi-grid" id="grid"></i>


                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                 
                                    <div class="container pt-3">
                                      <div class="gridItem">
                                                <div class="row" id="mission">
                                                   @Html.Partial("_gridView")
                                    
                                                </div>
                                             </div>   
                                      <div class="listItem" id="missionList">
                                        @Html.Partial("_listView")
                          
                                     
                         </div>
                     </div>
                   
                    <script>
                    @*----------------------------list-grid toggle---------------------------------*@
                                    $('.listItem').hide();
                                    $('#grid').click(function () {
                                        $('.gridItem').show();
                                        $('.listItem').hide();
                                    })
                                    $('#list').click(function () {
                                        $('.listItem').show();
                                        $('.gridItem').hide();
                                    })
                    @*--------------------------City AJAX------------------------------------------*@


                    function searchMission(){
                                 console.log("search");
                                 var search = $('input[name="search"]').val();
                                 var countries =[];
                                 var sort = $('#sortBy').find(":selected").val();
                                 var cities =[];
                                 var themes =[];
                                 var skills =[];
        
                                 $('input[name="country"]:checked').each(function(){
                                     countries.push(this.id);
                                 });
                                 $('input[name="city"]:checked').each(function(){
                                     cities.push(this.id);
                                 });
                                 $('input[name="theme"]:checked').each(function(){
                                     themes.push(this.id);
                                 });
                                 $('input[name="skill"]:checked').each(function(){
                                     skills.push(this.id);
                                 });

                                 debugger
                                 $.ajax({
                                     url:"/Mission/Search",
                                     method: "POST",
                                     data:{
                                         "search": search,
                                         "countries": countries,
                                         "cities": cities,
                                         "themes": themes,
                                         "skills": skills,
                                          "sort" : sort
                                     },
                                     success:function(data){
                                        $("#mission").html(data);
                                     },
                                     error: function(request,error){
                 
                                         console.log(error);
                                     }
                                 })

                                 debugger
                                  $.ajax({
                                     url:"/Mission/SearchList",
                                     method: "POST",
                                     data:{
                                         "search": search,
                                         "countries": countries,
                                         "cities": cities,
                                         "themes": themes,
                                         "skills": skills,
                                          "sort" : sort
                                     },
                                     success:function(data){
                                        $("#missionList").html(data);
                                     },
                                     error: function(request,error){
                 
                                         console.log(error);
                                     }
                                 })
                             };


                             function GetCity()
                                           {
                                            var countryId= [];
                                            $('input[name="country"]:checked').each(function(){
                                            countryId.push(this.id);
                                            });
                                            debugger;
                                            $.ajax({
                                            url:"/Mission/GetCity",
                                            method: "Post",
                                            data: {
                                            "countryId":countryId
                                            },
                                            success:function(data){
                                            data = JSON.parse(data);
                                            $("#selectCityList").empty();
                                            data.forEach((name)=> {
                                            document.getElementById("selectCityList").innerHTML += `

                                            <li>
                                            <div class="form-check dropdown-item px-3">
                                            <input class="form-check-input mx-auto" name="city" type="checkbox" value="${name.Name}"
                                            id="${name.CityId}" />
                                            <label class="form-check-label ps-2" for="${name.CityId}">
                                            ${name.Name}
                                            </label>
                                            </div>
                                            </li>
                                             `;
                                            })
                                            },
                                            error: function(request,error){
                                            console.log(error);
                                            }
                                            })
                                            };
                                </script>

                        <div class = "container py-5">

                        <nav aria-label="Page navigation example">
                          <ul class="pagination justify-content-center">
                            <li class="page-item">
                              <a class="page-link" href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                             </a>
                            </li>
                            <li class="page-item"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item"><a class="page-link" href="#">4</a></li>
                            <li class="page-item"><a class="page-link" href="#">5</a></li>
                            <li class="page-item"><a class="page-link" href="#">6</a></li>
                            <li class="page-item">
                              <a class="page-link" href="#" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                           
                              </a>
                            </li>
                          </ul>
                        </nav>
                        </div>
                    <div class="container">
                    <footer class="text-lg-start">
                     
                      <div class="p-3">
                       <a asp-action="Privacy" asp-controller="Home" class="text-decoration-none">Privacy Policy</a>
                     
                      </div>
                    
                    </footer>
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
                    <script type="text/javascript" language="javascript">
                        function DisableBackButton() {
                            window.history.forward();
                        }
                        DisableBackButton();
                        window.onload = DisableBackButton;
                        window.onpageshow = function (evt) { if (evt.persisted) DisableBackButton(); }
                        window.onunload = function () { void (0); };
                    </script>
                    

     
}
